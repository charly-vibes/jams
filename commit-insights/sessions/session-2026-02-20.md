# Commit Insights Development Session - 2026-02-20

## Overview

Created a single-page web application to visualize GitHub user commit activity over time. The app provides insights into commit production patterns, activity trends, and contribution statistics.

## Implementation

### Architecture

Built as a self-contained HTML file with inline CSS and JavaScript, following the same pattern as `beads-viewer`. Key design decisions:

1. **GitHub API Integration**: Uses the Events API to fetch public activity for any GitHub user
2. **Commit Extraction**: Parses PushEvents to extract commit data with timestamps, repositories, and messages
3. **Multi-timeframe Analysis**: Supports 7d, 30d, 90d, and 1-year views
4. **Client-side Processing**: All statistics and visualizations calculated in the browser

### Features Implemented

#### User Loading
- Accepts GitHub username input
- Fetches user profile via `/users/{username}` endpoint
- Fetches up to 300+ events via paginated `/users/{username}/events/public` endpoint
- Extracts commits from PushEvents
- Displays user avatar, name, and GitHub stats (repos, followers, following)

#### Statistics Dashboard
Four key metrics displayed prominently:
- **Total Commits**: Count of commits in selected time range
- **Average per Day**: Commit velocity metric
- **Current Streak**: Consecutive days with commits (from today backwards)
- **Longest Streak**: Maximum consecutive days with commits in the period

#### Activity Heatmap
GitHub-style contribution calendar:
- 12-week view with 7 days per week
- Color-coded intensity levels (0-4) based on commit count
- Tooltip on hover showing date and commit count
- Responsive grid layout

Color levels:
- Level 0: No commits (gray)
- Level 1: 1-2 commits (light green)
- Level 2: 3-5 commits (medium green)
- Level 3: 6-10 commits (darker green)
- Level 4: 10+ commits (darkest green)

#### Commits Over Time Chart
SVG line chart with area fill:
- Shows daily commit counts across selected time range
- Curved line for visual smoothness
- Semi-transparent area fill under the line
- Interactive points with tooltips
- Auto-scales based on maximum commit count
- Responsive to container width

#### Top Repositories
Ranked list showing:
- Repository name (owner/repo format)
- Commit count for each repository
- Limited to top 10 repositories
- Sorted by commit count (descending)

#### Recent Commits List
Display of last 20 commits showing:
- Repository name
- Commit message (first line only)
- Relative timestamp (Today, Yesterday, X days ago)
- Clean, scannable list format

### Technical Implementation

#### Data Flow
```
1. User Input → GitHub API
2. Fetch User Profile + Events (paginated)
3. Extract Commits from PushEvents
4. Calculate Statistics
5. Render Visualizations
```

#### Commit Extraction
PushEvents contain an array of commits. Each commit includes:
- SHA
- Message
- Author info
- Timestamp (from event.created_at)
- Repository name

The extraction aggregates all commits from all push events, providing a comprehensive view of activity.

#### Statistics Calculation
Implemented efficient algorithms for:

**Daily Aggregation**: Uses a Map to group commits by ISO date string
```javascript
dailyMap.set(day, (dailyMap.get(day) || 0) + 1);
```

**Streak Detection**:
- Current streak: Walk backwards from today until gap found
- Longest streak: Scan sorted dates, increment counter on consecutive days, reset on gaps

**Repository Breakdown**: Map-based aggregation by repo name, sorted by count

#### Visualization Techniques

**Heatmap Generation**:
- Creates 12 weeks × 7 days grid
- Calculates date for each cell (working backwards from today)
- Looks up commit count in daily map
- Assigns intensity level (0-4)
- Renders as CSS Grid with colored cells

**Line Chart**:
- SVG-based rendering for crisp scaling
- Data points mapped to coordinate system with padding
- Uses path commands (`M` for move, `L` for line)
- Area path follows line then closes at baseline
- Circle elements for data points with tooltips

### Design Philosophy

#### Visual Hierarchy
1. User profile card (identity + context)
2. Key metrics (quick insights)
3. Heatmap (patterns at a glance)
4. Trend chart (temporal analysis)
5. Repository breakdown (where work happens)
6. Commit details (drill-down data)

#### Color Scheme
Minimalist grayscale with accent color:
- Primary accent: `#C05D3C` (warm terracotta)
- Text hierarchy: primary, muted, light
- Cards with subtle shadows and borders
- Dark mode support via CSS custom properties

#### Typography
- Headings: Source Serif 4 (elegant, readable)
- UI elements: DM Sans (clean, modern)
- Code/data: JetBrains Mono (monospace clarity)

### URL State Management
- Stores `?user={username}` in URL
- Initializes from URL on page load
- Updates URL when loading new user
- Enables shareable links to specific users

### Responsive Design
- Flexbox/Grid layouts that adapt to screen size
- Mobile-friendly header with wrapping
- Stats grid collapses to single column on small screens
- Charts scale to container width
- Touch-friendly interaction targets

## Insights and Learnings

### 1. GitHub Events API Limitations
The Events API only returns the last ~90 days of activity, and is paginated at 30 events per page (max 100). To get comprehensive data:
- Fetch multiple pages (implemented up to 10 pages = ~300 events)
- This captures several weeks of active development
- For longer histories, would need different approach (e.g., per-repo commit queries)

### 2. PushEvent Structure
PushEvents are the richest source of commit data in the Events API:
- Each event can contain multiple commits (batched pushes)
- Commits in events include message, SHA, author
- Event timestamp is used (more reliable than commit timestamp for display)
- No line change data (additions/deletions) in Events API commits

### 3. Streak Calculation Complexity
Computing streaks requires careful date handling:
- Must account for timezone differences
- Use ISO date strings (YYYY-MM-DD) for consistent comparison
- Current streak must check today and walk backwards
- Longest streak requires sorted dates and gap detection
- Edge case: Single-day streak should count as 1, not 0

### 4. SVG Chart Rendering
SVG provides excellent chart quality:
- Scales crisply on all displays
- Small file size (no raster images)
- CSS styling applies cleanly
- Viewbox allows responsive sizing
- Path commands efficient for line/area charts

### 5. Performance Considerations
- All processing done client-side (no backend)
- Data volume manageable (~300-1000 commits typical)
- Map data structures for O(1) lookups
- Single pass for most aggregations
- Rendering optimized with template strings

## Challenges Solved

### 1. Heatmap Date Calculation
Computing 12 weeks backwards with proper date arithmetic:
- JavaScript Date objects handle month/year boundaries
- Working backwards ensures current week aligns right
- Grid displays Sunday-Saturday (week[0] = Sunday)

### 2. Chart Scaling
SVG coordinate mapping from data space to pixel space:
- Calculate max value for y-axis scaling
- Map indices to x positions with proper spacing
- Include padding for labels/overflow
- Maintain aspect ratio

### 3. Commit Deduplication
Events API can sometimes return duplicate events:
- Using commit SHA as key would deduplicate
- Decided to keep all (shows actual push activity)
- If needed, could use Set with SHA keys

### 4. Time Range Filtering
Efficient filtering for different time ranges:
- Pre-calculate cutoff date
- Filter commits array once
- Reuse filtered data for all visualizations
- Re-render on time range change without re-fetching

## Files Created

- `spec/functionality.md` - Feature specification
- `index.html` - Complete self-contained app
- `sessions/session-2026-02-20.md` - This document
- `/script.js` - Updated with 'commit-insights' in APPS array

## Testing

Tested with various GitHub users:
- Active contributors (high commit volume)
- Sporadic contributors (gaps in activity)
- New accounts (limited history)
- Users with varied repository portfolios

All scenarios handled gracefully with appropriate empty states and error messages.

## Future Enhancements

Potential additions for future versions:

1. **Extended History**: Query individual repositories for commits beyond 90-day event limit
2. **Language Breakdown**: Analyze repository languages if repo data fetched
3. **Contribution Types**: Distinguish pushes, PRs, issues, reviews
4. **Comparison Mode**: Compare two users side-by-side
5. **Export Data**: Download statistics as JSON/CSV
6. **Commit Message Analysis**: Word clouds, sentiment, common patterns
7. **Hour-of-day Heatmap**: When during day commits happen
8. **Team View**: Aggregate stats for organization members
9. **Caching**: LocalStorage cache to reduce API calls
10. **Authentication**: OAuth to access private repos and higher rate limits

## API Rate Limiting

The GitHub API has rate limits:
- Unauthenticated: 60 requests/hour
- Authenticated: 5000 requests/hour

Current implementation uses ~11 requests (1 user + 10 event pages), well within limits. For power users, could add:
- Rate limit display
- OAuth authentication option
- Request caching

## Conclusion

Successfully created a functional commit insights dashboard that provides meaningful visualization of GitHub activity. The app follows JAMS conventions (self-contained, minimalist, grayscale) and uses the GitHub API effectively to extract valuable commit production data.

The implementation demonstrates effective client-side data processing, responsive visualization design, and thoughtful UX for exploring developer activity patterns.
