# Post-it Wall - Development Session
## Date: 2026-01-07

## Overview
Created a minimal viable product for an infinite scrollable wall where users can create, edit, and manage post-it notes with markdown text support.

## Implementation Decisions

### 1. Canvas Architecture
- **Choice**: Used a fixed 5000x5000px canvas with browser scroll
- **Rationale**: Simplest approach for MVP; avoids complexity of drag-to-pan or virtual rendering
- **Trade-offs**: Limited to 5000x5000px area, but sufficient for typical use cases
- **Future**: Could implement infinite virtual canvas with viewport culling for true "infinite" feel

### 2. Markdown Parsing
- **Choice**: Custom lightweight markdown parser using regex
- **Rationale**: Avoids external dependencies; supports basic formatting (bold, italic, links, lists)
- **Implementation**: String replacement with regex patterns for common markdown syntax
- **Limitations**: Doesn't handle nested formatting or complex markdown features
- **Future**: Could add external library like marked.js for full markdown support if needed

### 3. Note Editing
- **Choice**: Inline editing with contentEditable
- **Rationale**: Direct manipulation; no modal required; feels natural
- **Behavior**:
  - Click note to edit (shows raw markdown)
  - Click outside or press Escape to save (renders parsed markdown)
  - Only one note editable at a time
- **Alternative considered**: Modal/popup editing (rejected for MVP simplicity)

### 4. Data Persistence
- **Choice**: localStorage with JSON serialization
- **Structure**: Each note contains: id, x, y, color, timestamp, text
- **Auto-save**: Saves on every change (color change, text edit, delete)
- **Limitations**: No sync across devices; limited storage (~5-10MB)
- **Future**: Could add export/import or cloud sync

### 5. Pattern System (Updated from Color System)
- **Patterns**: 5 grayscale patterns (solid, dots, horizontal lines, vertical lines, grid)
- **Rationale**: Grayscale maintains minimalist design philosophy; patterns provide visual differentiation without color
- **Implementation**: CSS data attributes with background-image patterns using gradients
- **Pattern Subtlety**:
  - High transparency (rgba 0.08-0.1) to avoid interfering with text readability
  - Generous spacing (14-20px) between pattern elements
  - Dotted line effects for horizontal/vertical patterns using multiple gradient stops
  - Small dot sizes (0.5px) for a delicate appearance
- **UI**: Inline pattern picker appears when editing, showing miniature previews with slightly higher opacity (rgba 0.12-0.15) for visibility
- **Design Changes**:
  - Originally used colorful post-its (yellow, pink, blue, green, white), changed to grayscale patterns
  - Further refined patterns to be more subtle with increased spacing and transparency

### 6. UI/UX Decisions
- **Grid background**: Subtle 100px grid to help with visual spacing
- **Toolbar**: Fixed at top with title and instructions
- **Footer**: Fixed at bottom with GitHub link
- **Note shadows**: Depth cue; increases on hover for feedback
- **Timestamp**: Auto-generated, shown in header (not editable)

## Code Structure

### HTML (`index.html`)
- Minimal structure: toolbar, canvas container, footer
- Canvas dynamically populated with notes via JavaScript

### CSS (`style.css`)
- Fixed positioning for toolbar/footer to maximize canvas space
- Absolute positioning for notes within canvas
- Grayscale design with pattern-differentiated notes
- CSS gradient patterns: solid, dots (radial-gradient), horizontal/vertical lines (repeating-linear-gradient), grid (combined gradients)
- Responsive note styling with hover effects

### JavaScript (`script.js`)
Key functions:
- `loadNotes()` / `saveNotes()`: localStorage persistence
- `parseMarkdown()`: Basic markdown-to-HTML conversion
- `createNoteElement()`: DOM generation for notes
- `editNote()` / `saveCurrentEdit()`: Edit mode management
- `createNote()`: New note creation at click position
- `changeNoteColor()` / `deleteNote()`: Note mutations

## Issues Encountered

### 1. Click Position Calculation
- **Problem**: Need to account for scroll offset when creating notes
- **Solution**: Calculate position relative to canvas, not viewport:
  ```javascript
  const x = e.clientX - rect.left + canvas.parentElement.scrollLeft;
  const y = e.clientY - rect.top + canvas.parentElement.scrollTop;
  ```

### 2. Event Bubbling
- **Problem**: Clicking inside note triggers canvas click handler
- **Solution**: Check `e.target === canvas` before creating new note

### 3. Edit Mode Management
- **Problem**: Multiple notes could be in edit mode simultaneously
- **Solution**: Track `currentlyEditing` globally; save previous edit before starting new one

### 4. Markdown Rendering Toggle
- **Problem**: Need to show raw markdown when editing, parsed HTML when viewing
- **Solution**: Toggle between `textContent` (raw) and `innerHTML` (parsed) based on edit mode

### 5. Cursor Positioning
- **Problem**: When entering edit mode, cursor defaults to start of text
- **Solution**: Use Selection API to place cursor at end:
  ```javascript
  const range = document.createRange();
  range.selectNodeContents(contentEl);
  range.collapse(false);
  ```

## Testing Recommendations
1. Create multiple notes at different positions
2. Test markdown formatting: **bold**, *italic*, [links](url), lists
3. Verify localStorage persistence across page reloads
4. Test pattern changes (solid, dots, lines-h, lines-v, grid) and note deletion
5. Test edit mode with Escape key and click-outside
6. Test scrolling to different canvas areas and creating notes there
7. Verify notes maintain position and pattern after reload
8. Verify pattern picker displays miniature versions of each pattern correctly

## Future Enhancements (Not in MVP)
- **Search/Filter**: Find notes by content or date
- **Export/Import**: JSON export for backup
- **Drag-to-move**: Reposition notes after creation
- **Resize notes**: Adjustable note dimensions
- **Z-index control**: Bring notes to front
- **Drag-to-pan**: Alternative to scroll navigation
- **Zoom**: Scale canvas for overview or detail
- **Rich text editor**: WYSIWYG instead of markdown
- **Note categories/tags**: Organize notes by topic
- **Multi-user sync**: Share walls across devices/users

## Lessons Learned
1. **Start simple**: Browser scroll is sufficient; don't over-engineer navigation
2. **Regex for basic markdown**: Custom parser works well for limited syntax
3. **ContentEditable caveats**: Need careful management of text vs HTML modes
4. **Global state**: Single `currentlyEditing` prevents UI inconsistencies
5. **Position calculation**: Always account for scroll offsets in click handlers
6. **CSS patterns over colors**: Using background gradients (radial-gradient, repeating-linear-gradient) allows creating rich visual patterns while maintaining grayscale aesthetic
7. **Pattern previews**: Smaller pattern sizes in picker (8-9px spacing) vs notes (14-20px spacing) provides clear previews while maintaining readability in actual notes
8. **Pattern subtlety matters**: Initial patterns were too intrusive; refinement to high transparency (rgba 0.08-0.1) and generous spacing makes patterns visible but not distracting from content
9. **Dotted line effect**: Creating dotted lines with CSS gradients requires multiple stops with gaps to simulate dashes rather than solid lines
