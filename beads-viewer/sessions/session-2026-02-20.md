# BeadsView Development Session - 2026-02-20

## Overview

Created a new single-page web application to visualize `.beads/issues.jsonl` files from GitHub repositories. The app provides a clean interface for browsing, filtering, and exploring issues tracked with the `bd` CLI tool.

## Implementation

### Architecture

Built as a self-contained HTML file with inline CSS and JavaScript, following the same pattern as `spec-viewer`. Key design decisions:

1. **GitHub API Integration**: Fetches `.beads/issues.jsonl` directly from repositories using the GitHub API
2. **JSONL Parsing**: Each line is parsed as a separate JSON object representing an issue
3. **Client-side Filtering**: All filtering, searching, and sorting happens in the browser
4. **Dependency Visualization**: Shows "blocks" and "blocked by" relationships between issues

### Features Implemented

#### Repository Loading
- Accepts GitHub URLs (`github.com/owner/repo`) or shorthand (`owner/repo`)
- Fetches `.beads/issues.jsonl` from the default branch
- Parses JSONL format (one JSON object per line)
- Handles missing files with clear error messages

#### Issue List (Sidebar)
- Displays all issues with ID, title, status, type, and priority
- Real-time filtering by:
  - Status: all, open, closed
  - Type: all, task, bug, feature, epic
  - Priority: all, P1, P2, P3
- Search by title or description
- Click to view details
- Shows statistics (total/open/closed counts)

#### Issue Details (Main Area)
- Full metadata display:
  - ID, title, description (preserves formatting)
  - Status badge, type badge, priority badge
  - Owner, created/updated timestamps
  - Close reason and timestamp (if applicable)
- Dependency visualization:
  - "Blocked By" section shows issues that must complete first
  - "Blocks" section shows issues waiting on this one
  - Click dependencies to navigate

#### Visual Design
- Minimalist grayscale color scheme
- Clean typography (Source Serif 4 for headings, DM Sans for UI, JetBrains Mono for code)
- Responsive layout with sidebar and main content area
- Dark mode support (auto-detects system preference)
- Smooth transitions and hover states

### Data Structure

Issues from `.beads/issues.jsonl` have this structure:

```json
{
  "id": "fabbro-096",
  "title": "Issue title",
  "description": "Full description...",
  "status": "open|closed",
  "priority": 1-3,
  "issue_type": "task|bug|feature|epic",
  "owner": "email@example.com",
  "created_at": "2026-01-29T18:06:45Z",
  "created_by": "name",
  "updated_at": "2026-01-29T19:23:27Z",
  "closed_at": "2026-01-29T19:23:27Z",
  "close_reason": "Closed",
  "dependencies": [
    {
      "issue_id": "fabbro-096",
      "depends_on_id": "fabbro-10e",
      "type": "blocks",
      "created_at": "2026-01-29T18:07:09Z",
      "created_by": "charly vibes"
    }
  ]
}
```

### Technical Implementation

#### Dependency Logic
The dependency parsing was the most complex part:

1. **Blocks relationships**: If issue A has `{type: "blocks", depends_on_id: B}` in its dependencies, then A blocks B
2. **Blocked By**: To find what blocks issue X, scan all other issues for dependencies where `depends_on_id === X.id` and `type === "blocks"`

This bidirectional lookup allows showing both perspectives in the UI.

#### URL State Management
- Stores `?repo=owner/repo&issue=issue-id` in URL
- Supports direct linking to specific issues
- Initializes from URL on page load
- Updates URL when navigating between issues

### Testing

Tested with real repositories:
- `charly-vibes/fabbro` (Go project with many issues)
- Can test with any repo that has `.beads/issues.jsonl`

## Insights

1. **JSONL Format**: The newline-delimited JSON format is simple and git-friendly. Each line is a complete JSON object, making it easy to parse and resilient to line-based git operations.

2. **Dependency Model**: The "blocks" relationship type is unidirectional in the data but needs bidirectional display. This required scanning all issues to build the reverse index.

3. **GitHub API**: Using the raw content API (`Accept: application/vnd.github.v3.raw`) is simpler than decoding base64 from the default response.

4. **Badge Design**: Color-coded badges for status/type/priority provide quick visual scanning while maintaining accessibility in both light and dark modes.

## Future Enhancements

Potential additions (not implemented):

- Branch selector (currently uses default branch only)
- Dependency graph visualization (interactive diagram)
- Filtering by owner/creator
- Export filtered list as JSON/CSV
- Timeline view showing issue activity
- Epic/child relationship visualization
- Comment display (if supported in future bd versions)

## Files Created

- `spec/functionality.md` - Feature specification
- `index.html` - Complete self-contained app
- `sessions/session-2026-02-20.md` - This document

## Registration

Added `'beads-viewer'` to the APPS array in `/jams/script.js` to register it on the index page.
